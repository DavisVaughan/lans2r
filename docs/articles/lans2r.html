<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NanoSIMS data processing of LANS data in R â€¢ lans2r</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="NanoSIMS data processing of LANS data in R">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lans2r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/lans2r.html">Introduction</a>
</li>
<li>
  <a href="../articles/lans2r-hmr.html">HMR Files</a>
</li>
<li>
  <a href="../articles/lans2r-calculate.html">Calculations</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kopflab/lans2r">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>NanoSIMS data processing of LANS data in R</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/KopfLab/lans2r/blob/master/vignettes/lans2r.Rmd"><code>vignettes/lans2r.Rmd</code></a></small>
      <div class="hidden name"><code>lans2r.Rmd</code></div>

    </div>

    
    
<p>This R markdown example demonstrates the basic functionality of the <strong>lans2r</strong> package.</p>
<div id="load-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-data" class="anchor"></a>Load data</h2>
<p>To load data into R, export it from LANS which creates a folder for each analysis with sub folders <strong>dat</strong> containing the aggregated information about the different ROIs (in text file format) and <strong>mat</strong> containing the raw ion maps (in Matlab file format). Both of these can be imported easily with this package. For easier demonstration <strong>lans2r</strong> bundles a set of 3 analyses (folders <code>analysis1</code>, <code>analysis2</code> and <code>analysis3</code>) with the package sources.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lans2r)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(knitr)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">folder &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"nanosims_data"</span>, <span class="dt">package =</span> <span class="st">"lans2r"</span>) <span class="co"># data base directory</span></a></code></pre></div>
<div id="roi-overview-data" class="section level3">
<h3 class="hasAnchor">
<a href="#roi-overview-data" class="anchor"></a>ROI overview data</h3>
<p>This loads the ROI overview data for the 3 analyses and assigns some additional information to the analyses (here rather random, column <code>info</code>). Since the parameters <code>quiet=F</code> indicates that information messages should be provided, it also outputs a summary of the loaded data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/load_LANS_summary.html">load_LANS_summary</a></span> (</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">    <span class="dt">analysis =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"analysis1"</span>, <span class="st">"analysis2"</span>, <span class="st">"analysis3"</span>), <span class="co"># the analysis folders</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    <span class="dt">base_dir =</span> folder, <span class="co"># the data base director</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">    <span class="dt">load_zstacks =</span> <span class="ot">TRUE</span>, <span class="co"># whether to load z-stacks as well (have to be exported from LANS!)</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    <span class="dt">info =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"turtle"</span>, <span class="st">"jetpack"</span>, <span class="st">"pizza"</span>), <span class="co"># any additional information about the analyses</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">    <span class="dt">quiet =</span> <span class="ot">FALSE</span> <span class="co"># output information about the files</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  ) </a></code></pre></div>
<pre><code>## INFO: folder 'analysis1' read successfully.
##       Data for 37 ROIs with 4 ions recovered: 12C, 13C, 14N12C, 15N12C.
##       Z-stacks were loaded. Recovered 2 planes.</code></pre>
<pre><code>## INFO: folder 'analysis2' read successfully.
##       Data for 33 ROIs with 4 ions recovered: 12C, 13C, 14N12C, 15N12C.
##       Z-stacks were loaded. Recovered 2 planes.</code></pre>
<pre><code>## INFO: folder 'analysis3' read successfully.
##       Data for 34 ROIs with 4 ions recovered: 12C, 13C, 14N12C, 15N12C.
##       Z-stacks were loaded. Recovered 2 planes.</code></pre>
<p>To calculate ratios and abundances, simply specificy which ions you would like to ratio. Note: for convenience, we make use of the pipe operator <code><a href="https://dplyr.tidyverse.org/reference/reexports.html">%&gt;%</a></code> for chaining multiple operations. For more information on the pipe, take a look at the <a href="https://CRAN.R-project.org/package=magrittr">magrittr package</a>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/calculate_sums.html">calculate_sums</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">`</span><span class="dt">13C</span><span class="st">`</span>, <span class="st">`</span><span class="dt">12C</span><span class="st">`</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">`</span><span class="dt">15N12C</span><span class="st">`</span>, <span class="st">`</span><span class="dt">14N12C</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/calculate_ratios.html">calculate_ratios</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">`</span><span class="dt">13C</span><span class="st">`</span>, <span class="st">`</span><span class="dt">12C</span><span class="st">`</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">`</span><span class="dt">15N12C</span><span class="st">`</span>, <span class="st">`</span><span class="dt">14N12C</span><span class="st">`</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">`</span><span class="dt">13C+12C</span><span class="st">`</span>, <span class="st">`</span><span class="dt">15N12C+14N12C</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="../reference/calculate_abundances.html">calculate_abundances</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">`</span><span class="dt">13C</span><span class="st">`</span>, <span class="st">`</span><span class="dt">12C</span><span class="st">`</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">`</span><span class="dt">15N12C</span><span class="st">`</span>, <span class="st">`</span><span class="dt">14N12C</span><span class="st">`</span>)) </a></code></pre></div>
<pre><code>## INFO: 624 'ion_sum' values + errors calculated, 624 added (subset: all)
##       values added (stored in 'variable' column): '13C+12C' (312x), '15N12C+14N12C' (312x)</code></pre>
<pre><code>## INFO: 936 'ratio' values + errors calculated, 936 added (subset: all)
##       values added (stored in 'variable' column): '13C/12C' (312x), '13C+12C/15N12C+14N12C' (312x), '15N12C/14N12C' (312x)</code></pre>
<pre><code>## INFO: 624 'abundance' values + errors calculated, 624 added (subset: all)
##       values added (stored in 'variable' column): '13C F' (312x), '15N12C F' (312x)</code></pre>
<p>For additional operations, one can use the more generic <code>calculate</code> function and provide custom functions for value and error calculations and name construction. Here, we have APE (atom percent enrichment) as an example. For additional examples on <code>calculate</code>, see the <code><a href="../articles/lans2r-calculate.html">vignette("lans2r-calculate")</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">F13C_natural =</span> <span class="fl">1.11</span><span class="op">/</span><span class="dv">100</span>, <span class="dt">F15N_natural =</span> <span class="fl">0.366</span><span class="op">/</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/calculate.html">calculate</a></span>(</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">    <span class="dt">data_type =</span> <span class="st">"APE"</span>,</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">    <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">`</span><span class="dt">13C F</span><span class="st">`</span>, <span class="st">`</span><span class="dt">F13C_natural</span><span class="st">`</span>, <span class="st">`</span><span class="dt">13C F sigma</span><span class="st">`</span>), </a>
<a class="sourceLine" id="cb10-6" data-line-number="6">    <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">`</span><span class="dt">15N12C F</span><span class="st">`</span>, <span class="st">`</span><span class="dt">F15N_natural</span><span class="st">`</span>, <span class="st">`</span><span class="dt">15N12C F sigma</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">    <span class="co"># calculate the APE value as the fractional abundance enrichment above natural</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8">    <span class="dt">value_fun =</span> <span class="cf">function</span>(val, nat, sigma) <span class="dv">100</span><span class="op">*</span>(val <span class="op">-</span><span class="st"> </span>nat),</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">    <span class="co"># assume the error in natural abundance is negligible so only F error propagates</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10">    <span class="dt">error_fun =</span> <span class="cf">function</span>(val, nat, sigma) <span class="dv">100</span><span class="op">*</span>sigma,</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">    <span class="co"># replace the F in the existing columnes with APE to make the new variable</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12">    <span class="dt">name_fun =</span> <span class="cf">function</span>(val, ...) <span class="kw"><a href="https://rdrr.io/r/base/grep.html">sub</a></span>(<span class="st">"F"</span>, <span class="st">"APE [%]"</span>, <span class="kw"><a href="https://rdrr.io/r/base/deparse.html">deparse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(val)))</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">  )</a></code></pre></div>
<pre><code>## INFO: 624 'APE' values + errors calculated, 624 added (subset: all)
##       values added (stored in 'variable' column): '13C APE [%]' (312x), '15N12C APE [%]' (312x)</code></pre>
<div id="overview" class="section level4">
<h4 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h4>
<p>Letâ€™s take a look at the first couple of rows of the data frame.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="dt">n=</span><span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">analysis</th>
<th align="left">info</th>
<th align="left">plane</th>
<th align="right">ROI</th>
<th align="left">data_type</th>
<th align="left">variable</th>
<th align="right">value</th>
<th align="right">sigma</th>
<th align="right">coord_x</th>
<th align="right">coord_y</th>
<th align="right">size</th>
<th align="right">pixels</th>
<th align="right">LW_ratio</th>
<th align="right">F13C_natural</th>
<th align="right">F15N_natural</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">1</td>
<td align="left">ion_count</td>
<td align="left">12C</td>
<td align="right">1895850</td>
<td align="right">1376.89869</td>
<td align="right">17.38</td>
<td align="right">192.93</td>
<td align="right">0.83</td>
<td align="right">353</td>
<td align="right">2.45</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">2</td>
<td align="left">ion_count</td>
<td align="left">12C</td>
<td align="right">1273919</td>
<td align="right">1128.68020</td>
<td align="right">18.39</td>
<td align="right">175.25</td>
<td align="right">0.75</td>
<td align="right">290</td>
<td align="right">1.57</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">3</td>
<td align="left">ion_count</td>
<td align="left">12C</td>
<td align="right">1315417</td>
<td align="right">1146.91630</td>
<td align="right">40.38</td>
<td align="right">168.26</td>
<td align="right">0.70</td>
<td align="right">250</td>
<td align="right">1.66</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">4</td>
<td align="left">ion_count</td>
<td align="left">12C</td>
<td align="right">1289955</td>
<td align="right">1135.76186</td>
<td align="right">42.05</td>
<td align="right">207.80</td>
<td align="right">0.72</td>
<td align="right">267</td>
<td align="right">2.16</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">5</td>
<td align="left">ion_count</td>
<td align="left">12C</td>
<td align="right">1756159</td>
<td align="right">1325.20149</td>
<td align="right">42.92</td>
<td align="right">147.66</td>
<td align="right">0.81</td>
<td align="right">334</td>
<td align="right">2.50</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">6</td>
<td align="left">ion_count</td>
<td align="left">12C</td>
<td align="right">1023934</td>
<td align="right">1011.89624</td>
<td align="right">46.56</td>
<td align="right">103.93</td>
<td align="right">0.67</td>
<td align="right">232</td>
<td align="right">2.11</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">7</td>
<td align="left">ion_count</td>
<td align="left">12C</td>
<td align="right">5509</td>
<td align="right">74.22264</td>
<td align="right">52.29</td>
<td align="right">22.77</td>
<td align="right">1.32</td>
<td align="right">893</td>
<td align="right">1.09</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">8</td>
<td align="left">ion_count</td>
<td align="left">12C</td>
<td align="right">1117870</td>
<td align="right">1057.29372</td>
<td align="right">61.77</td>
<td align="right">120.06</td>
<td align="right">0.62</td>
<td align="right">195</td>
<td align="right">2.39</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">9</td>
<td align="left">ion_count</td>
<td align="left">12C</td>
<td align="right">1122839</td>
<td align="right">1059.64098</td>
<td align="right">63.38</td>
<td align="right">146.02</td>
<td align="right">0.65</td>
<td align="right">217</td>
<td align="right">2.02</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">10</td>
<td align="left">ion_count</td>
<td align="left">12C</td>
<td align="right">1046665</td>
<td align="right">1023.06647</td>
<td align="right">74.39</td>
<td align="right">98.29</td>
<td align="right">0.66</td>
<td align="right">221</td>
<td align="right">2.23</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
</tr>
</tbody>
</table>
<p>Since this is now in long format so itâ€™s easy to have both <code>value</code> and the <code>sigma</code> error, itâ€™s hard to see line by line what is going on, letâ€™s look just at <code>analysis1</code> and recast the values into a wide format using the <code>spread_data</code> function.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/spread_data.html">spread_data</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="dt">n=</span><span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">analysis</th>
<th align="left">info</th>
<th align="left">plane</th>
<th align="right">ROI</th>
<th align="right">coord_x</th>
<th align="right">coord_y</th>
<th align="right">size</th>
<th align="right">pixels</th>
<th align="right">LW_ratio</th>
<th align="right">F13C_natural</th>
<th align="right">F15N_natural</th>
<th align="right">12C</th>
<th align="right">13C</th>
<th align="right">13C APE [%]</th>
<th align="right">13C F</th>
<th align="right">13C/12C</th>
<th align="right">13C+12C</th>
<th align="right">13C+12C/15N12C+14N12C</th>
<th align="right">14N12C</th>
<th align="right">15N12C</th>
<th align="right">15N12C APE [%]</th>
<th align="right">15N12C F</th>
<th align="right">15N12C/14N12C</th>
<th align="right">15N12C+14N12C</th>
<th align="right">12C sigma</th>
<th align="right">13C APE [%] sigma</th>
<th align="right">13C F sigma</th>
<th align="right">13C sigma</th>
<th align="right">13C/12C sigma</th>
<th align="right">13C+12C sigma</th>
<th align="right">13C+12C/15N12C+14N12C sigma</th>
<th align="right">14N12C sigma</th>
<th align="right">15N12C APE [%] sigma</th>
<th align="right">15N12C F sigma</th>
<th align="right">15N12C sigma</th>
<th align="right">15N12C/14N12C sigma</th>
<th align="right">15N12C+14N12C sigma</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">1</td>
<td align="right">17.38</td>
<td align="right">192.93</td>
<td align="right">0.83</td>
<td align="right">353</td>
<td align="right">2.45</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">1895850</td>
<td align="right">24315</td>
<td align="right">0.1562974</td>
<td align="right">0.0126630</td>
<td align="right">0.0128254</td>
<td align="right">1920165</td>
<td align="right">0.2413707</td>
<td align="right">7839685</td>
<td align="right">115568</td>
<td align="right">1.0867256</td>
<td align="right">0.0145273</td>
<td align="right">0.0147414</td>
<td align="right">7955253</td>
<td align="right">1376.89869</td>
<td align="right">0.0080692</td>
<td align="right">0.0000807</td>
<td align="right">155.932678</td>
<td align="right">0.0000828</td>
<td align="right">1385.70018</td>
<td align="right">0.0001941</td>
<td align="right">2799.9437</td>
<td align="right">0.0042422</td>
<td align="right">0.0000424</td>
<td align="right">339.95294</td>
<td align="right">0.0000437</td>
<td align="right">2820.5058</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">2</td>
<td align="right">18.39</td>
<td align="right">175.25</td>
<td align="right">0.75</td>
<td align="right">290</td>
<td align="right">1.57</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">1273919</td>
<td align="right">16087</td>
<td align="right">0.1370485</td>
<td align="right">0.0124705</td>
<td align="right">0.0126280</td>
<td align="right">1290006</td>
<td align="right">0.2259213</td>
<td align="right">5625982</td>
<td align="right">83997</td>
<td align="right">1.1050562</td>
<td align="right">0.0147106</td>
<td align="right">0.0149302</td>
<td align="right">5709979</td>
<td align="right">1128.68020</td>
<td align="right">0.0097706</td>
<td align="right">0.0000977</td>
<td align="right">126.834538</td>
<td align="right">0.0001002</td>
<td align="right">1135.78431</td>
<td align="right">0.0002202</td>
<td align="right">2371.9153</td>
<td align="right">0.0050382</td>
<td align="right">0.0000504</td>
<td align="right">289.82236</td>
<td align="right">0.0000519</td>
<td align="right">2389.5562</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">3</td>
<td align="right">40.38</td>
<td align="right">168.26</td>
<td align="right">0.70</td>
<td align="right">250</td>
<td align="right">1.66</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">1315417</td>
<td align="right">17084</td>
<td align="right">0.1721004</td>
<td align="right">0.0128210</td>
<td align="right">0.0129875</td>
<td align="right">1332501</td>
<td align="right">0.2262195</td>
<td align="right">5802914</td>
<td align="right">87388</td>
<td align="right">1.1175912</td>
<td align="right">0.0148359</td>
<td align="right">0.0150593</td>
<td align="right">5890302</td>
<td align="right">1146.91630</td>
<td align="right">0.0097460</td>
<td align="right">0.0000975</td>
<td align="right">130.705777</td>
<td align="right">0.0001000</td>
<td align="right">1154.34007</td>
<td align="right">0.0002170</td>
<td align="right">2408.9238</td>
<td align="right">0.0049813</td>
<td align="right">0.0000498</td>
<td align="right">295.61461</td>
<td align="right">0.0000513</td>
<td align="right">2426.9944</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">4</td>
<td align="right">42.05</td>
<td align="right">207.80</td>
<td align="right">0.72</td>
<td align="right">267</td>
<td align="right">2.16</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">1289955</td>
<td align="right">16221</td>
<td align="right">0.1318694</td>
<td align="right">0.0124187</td>
<td align="right">0.0125749</td>
<td align="right">1306176</td>
<td align="right">0.2229323</td>
<td align="right">5773380</td>
<td align="right">85690</td>
<td align="right">1.0965188</td>
<td align="right">0.0146252</td>
<td align="right">0.0148423</td>
<td align="right">5859070</td>
<td align="right">1135.76186</td>
<td align="right">0.0096900</td>
<td align="right">0.0000969</td>
<td align="right">127.361690</td>
<td align="right">0.0000994</td>
<td align="right">1142.88057</td>
<td align="right">0.0002157</td>
<td align="right">2402.7859</td>
<td align="right">0.0049595</td>
<td align="right">0.0000496</td>
<td align="right">292.72854</td>
<td align="right">0.0000511</td>
<td align="right">2420.5516</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">5</td>
<td align="right">42.92</td>
<td align="right">147.66</td>
<td align="right">0.81</td>
<td align="right">334</td>
<td align="right">2.50</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">1756159</td>
<td align="right">22267</td>
<td align="right">0.1420622</td>
<td align="right">0.0125206</td>
<td align="right">0.0126794</td>
<td align="right">1778426</td>
<td align="right">0.2427387</td>
<td align="right">7218762</td>
<td align="right">107741</td>
<td align="right">1.1045652</td>
<td align="right">0.0147057</td>
<td align="right">0.0149251</td>
<td align="right">7326503</td>
<td align="right">1325.20149</td>
<td align="right">0.0083379</td>
<td align="right">0.0000834</td>
<td align="right">149.221312</td>
<td align="right">0.0000855</td>
<td align="right">1333.57639</td>
<td align="right">0.0002029</td>
<td align="right">2686.7754</td>
<td align="right">0.0044471</td>
<td align="right">0.0000445</td>
<td align="right">328.23924</td>
<td align="right">0.0000458</td>
<td align="right">2706.7514</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">6</td>
<td align="right">46.56</td>
<td align="right">103.93</td>
<td align="right">0.67</td>
<td align="right">232</td>
<td align="right">2.11</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">1023934</td>
<td align="right">13166</td>
<td align="right">0.1595015</td>
<td align="right">0.0126950</td>
<td align="right">0.0128583</td>
<td align="right">1037100</td>
<td align="right">0.2303558</td>
<td align="right">4434979</td>
<td align="right">67186</td>
<td align="right">1.1263043</td>
<td align="right">0.0149230</td>
<td align="right">0.0151491</td>
<td align="right">4502165</td>
<td align="right">1011.89624</td>
<td align="right">0.0109934</td>
<td align="right">0.0001099</td>
<td align="right">114.743191</td>
<td align="right">0.0001128</td>
<td align="right">1018.38107</td>
<td align="right">0.0002509</td>
<td align="right">2105.9390</td>
<td align="right">0.0057142</td>
<td align="right">0.0000571</td>
<td align="right">259.20262</td>
<td align="right">0.0000589</td>
<td align="right">2121.8306</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">7</td>
<td align="right">52.29</td>
<td align="right">22.77</td>
<td align="right">1.32</td>
<td align="right">893</td>
<td align="right">1.09</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">5509</td>
<td align="right">75</td>
<td align="right">0.2331232</td>
<td align="right">0.0134312</td>
<td align="right">0.0136141</td>
<td align="right">5584</td>
<td align="right">0.1079555</td>
<td align="right">51019</td>
<td align="right">706</td>
<td align="right">0.9989106</td>
<td align="right">0.0136491</td>
<td align="right">0.0138380</td>
<td align="right">51725</td>
<td align="right">74.22264</td>
<td align="right">0.1540455</td>
<td align="right">0.0015405</td>
<td align="right">8.660254</td>
<td align="right">0.0015827</td>
<td align="right">74.72617</td>
<td align="right">0.0015207</td>
<td align="right">225.8739</td>
<td align="right">0.0510173</td>
<td align="right">0.0005102</td>
<td align="right">26.57066</td>
<td align="right">0.0005244</td>
<td align="right">227.4313</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">8</td>
<td align="right">61.77</td>
<td align="right">120.06</td>
<td align="right">0.62</td>
<td align="right">195</td>
<td align="right">2.39</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">1117870</td>
<td align="right">13971</td>
<td align="right">0.1243607</td>
<td align="right">0.0123436</td>
<td align="right">0.0124979</td>
<td align="right">1131841</td>
<td align="right">0.2294823</td>
<td align="right">4858391</td>
<td align="right">73758</td>
<td align="right">1.1294536</td>
<td align="right">0.0149545</td>
<td align="right">0.0151816</td>
<td align="right">4932149</td>
<td align="right">1057.29372</td>
<td align="right">0.0103784</td>
<td align="right">0.0001038</td>
<td align="right">118.198985</td>
<td align="right">0.0001064</td>
<td align="right">1063.88016</td>
<td align="right">0.0002392</td>
<td align="right">2204.1758</td>
<td align="right">0.0054651</td>
<td align="right">0.0000547</td>
<td align="right">271.58424</td>
<td align="right">0.0000563</td>
<td align="right">2220.8442</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">9</td>
<td align="right">63.38</td>
<td align="right">146.02</td>
<td align="right">0.65</td>
<td align="right">217</td>
<td align="right">2.02</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">1122839</td>
<td align="right">14201</td>
<td align="right">0.1389446</td>
<td align="right">0.0124894</td>
<td align="right">0.0126474</td>
<td align="right">1137040</td>
<td align="right">0.2325619</td>
<td align="right">4818643</td>
<td align="right">70550</td>
<td align="right">1.0769784</td>
<td align="right">0.0144298</td>
<td align="right">0.0146411</td>
<td align="right">4889193</td>
<td align="right">1059.64098</td>
<td align="right">0.0104149</td>
<td align="right">0.0001041</td>
<td align="right">119.167949</td>
<td align="right">0.0001068</td>
<td align="right">1066.32078</td>
<td align="right">0.0002421</td>
<td align="right">2195.1408</td>
<td align="right">0.0053933</td>
<td align="right">0.0000539</td>
<td align="right">265.61250</td>
<td align="right">0.0000555</td>
<td align="right">2211.1520</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">all</td>
<td align="right">10</td>
<td align="right">74.39</td>
<td align="right">98.29</td>
<td align="right">0.66</td>
<td align="right">221</td>
<td align="right">2.23</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">1046665</td>
<td align="right">13408</td>
<td align="right">0.1548186</td>
<td align="right">0.0126482</td>
<td align="right">0.0128102</td>
<td align="right">1060073</td>
<td align="right">0.2328937</td>
<td align="right">4484536</td>
<td align="right">67210</td>
<td align="right">1.1105762</td>
<td align="right">0.0147658</td>
<td align="right">0.0149871</td>
<td align="right">4551746</td>
<td align="right">1023.06647</td>
<td align="right">0.0108538</td>
<td align="right">0.0001085</td>
<td align="right">115.792919</td>
<td align="right">0.0001113</td>
<td align="right">1029.59847</td>
<td align="right">0.0002512</td>
<td align="right">2117.6723</td>
<td align="right">0.0056534</td>
<td align="right">0.0000565</td>
<td align="right">259.24892</td>
<td align="right">0.0000582</td>
<td align="right">2133.4821</td>
</tr>
</tbody>
</table>
<p>Or for more specific overviews, for example, only the abundance and APE, only the data values (excluding the errors) and only the first plane of the first few ROIs</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(data_type <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"abundance"</span>, <span class="st">"APE"</span>), plane <span class="op">==</span><span class="st"> "1"</span>, ROI <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/spread_data.html">spread_data</a></span>(<span class="dt">errors =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">analysis</th>
<th align="left">info</th>
<th align="left">plane</th>
<th align="right">ROI</th>
<th align="right">coord_x</th>
<th align="right">coord_y</th>
<th align="right">size</th>
<th align="right">pixels</th>
<th align="right">LW_ratio</th>
<th align="right">F13C_natural</th>
<th align="right">F15N_natural</th>
<th align="right">13C APE [%]</th>
<th align="right">13C F</th>
<th align="right">15N12C APE [%]</th>
<th align="right">15N12C F</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">1</td>
<td align="right">1</td>
<td align="right">17.38</td>
<td align="right">192.93</td>
<td align="right">0.83</td>
<td align="right">353</td>
<td align="right">2.45</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">0.1645876</td>
<td align="right">0.0127459</td>
<td align="right">1.058593</td>
<td align="right">0.0142459</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">1</td>
<td align="right">2</td>
<td align="right">18.39</td>
<td align="right">175.25</td>
<td align="right">0.75</td>
<td align="right">290</td>
<td align="right">1.57</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">0.1446352</td>
<td align="right">0.0125464</td>
<td align="right">1.090331</td>
<td align="right">0.0145633</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="left">turtle</td>
<td align="left">1</td>
<td align="right">3</td>
<td align="right">40.38</td>
<td align="right">168.26</td>
<td align="right">0.70</td>
<td align="right">250</td>
<td align="right">1.66</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">0.1711441</td>
<td align="right">0.0128114</td>
<td align="right">1.092983</td>
<td align="right">0.0145898</td>
</tr>
<tr class="even">
<td align="left">analysis2</td>
<td align="left">jetpack</td>
<td align="left">1</td>
<td align="right">1</td>
<td align="right">25.28</td>
<td align="right">128.10</td>
<td align="right">1.38</td>
<td align="right">976</td>
<td align="right">1.04</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">0.2299359</td>
<td align="right">0.0133994</td>
<td align="right">2.633973</td>
<td align="right">0.0299997</td>
</tr>
<tr class="odd">
<td align="left">analysis2</td>
<td align="left">jetpack</td>
<td align="left">1</td>
<td align="right">2</td>
<td align="right">28.10</td>
<td align="right">203.98</td>
<td align="right">0.66</td>
<td align="right">221</td>
<td align="right">2.29</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">0.5019285</td>
<td align="right">0.0161193</td>
<td align="right">3.283767</td>
<td align="right">0.0364977</td>
</tr>
<tr class="even">
<td align="left">analysis2</td>
<td align="left">jetpack</td>
<td align="left">1</td>
<td align="right">3</td>
<td align="right">40.89</td>
<td align="right">21.97</td>
<td align="right">0.66</td>
<td align="right">225</td>
<td align="right">1.73</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">0.4311799</td>
<td align="right">0.0154118</td>
<td align="right">3.361709</td>
<td align="right">0.0372771</td>
</tr>
<tr class="odd">
<td align="left">analysis3</td>
<td align="left">pizza</td>
<td align="left">1</td>
<td align="right">1</td>
<td align="right">31.42</td>
<td align="right">209.93</td>
<td align="right">0.82</td>
<td align="right">348</td>
<td align="right">3.32</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">0.4568719</td>
<td align="right">0.0156687</td>
<td align="right">3.324170</td>
<td align="right">0.0369017</td>
</tr>
<tr class="even">
<td align="left">analysis3</td>
<td align="left">pizza</td>
<td align="left">1</td>
<td align="right">2</td>
<td align="right">32.36</td>
<td align="right">37.12</td>
<td align="right">0.73</td>
<td align="right">276</td>
<td align="right">1.89</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">0.2947689</td>
<td align="right">0.0140477</td>
<td align="right">3.316543</td>
<td align="right">0.0368254</td>
</tr>
<tr class="odd">
<td align="left">analysis3</td>
<td align="left">pizza</td>
<td align="left">1</td>
<td align="right">3</td>
<td align="right">40.78</td>
<td align="right">151.29</td>
<td align="right">1.50</td>
<td align="right">1158</td>
<td align="right">1.55</td>
<td align="right">0.0111</td>
<td align="right">0.00366</td>
<td align="right">0.0854406</td>
<td align="right">0.0119544</td>
<td align="right">2.731920</td>
<td align="right">0.0309792</td>
</tr>
</tbody>
</table>
</div>
<div id="plotting" class="section level4">
<h4 class="hasAnchor">
<a href="#plotting" class="anchor"></a>Plotting</h4>
<p>Plot all the data using the <em>ggplot</em> package.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(size, value, <span class="dt">color =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(analysis, info), <span class="dt">shape =</span> plane) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">ymin =</span> value <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>sigma, <span class="dt">ymax =</span> value <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>sigma), <span class="dt">colour=</span><span class="st">"black"</span>, <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"ROI size ["</span><span class="op">*</span>mu<span class="op">*</span><span class="st">"m"</span><span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="st">"]"</span>), <span class="dt">y=</span><span class="st">""</span>, </a>
<a class="sourceLine" id="cb15-8" data-line-number="8">         <span class="dt">title =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="st">"ROI summary (2"</span><span class="op">*</span>sigma<span class="op">*</span><span class="st">" error bars, may be smaller than symbols)"</span>),</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">         <span class="dt">color =</span> <span class="st">"Analysis"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>variable, <span class="dt">scales=</span><span class="st">"free"</span>, <span class="dt">nrow =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</a></code></pre></div>
<p><img src="lans2r_files/figure-html/unnamed-chunk-8-1.png" width="1152"></p>
<p>Focus in on the combined counts (not the individual planes from the z-stack) and look just at ratios:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/last_plot.html">last_plot</a></span>() <span class="op">%+%</span><span class="st"> </span>(data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(plane <span class="op">==</span><span class="st"> "all"</span>, data_type <span class="op">==</span><span class="st"> "ratio"</span>))</a></code></pre></div>
<p><img src="lans2r_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
</div>
</div>
<div id="ion-maps" class="section level3">
<h3 class="hasAnchor">
<a href="#ion-maps" class="anchor"></a>Ion maps</h3>
<p>Again, loading the ion maps for all 3 analyses.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">maps &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/load_LANS_maps.html">load_LANS_maps</a></span> (</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">    <span class="dt">analysis =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"analysis1"</span>, <span class="st">"analysis2"</span>, <span class="st">"analysis3"</span>),</a>
<a class="sourceLine" id="cb17-4" data-line-number="4">    <span class="dt">base_dir =</span> folder</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">  ) </a></code></pre></div>
<pre><code>## INFO: folder 'analysis1' read successfully.
##       Ion map data for 256 x 256 pixel frame (10.014 microm^2) for 4 ions recovered: 12C, 13C, 14N12C, 15N12C.
##       37 ROIs identified in the frame.</code></pre>
<pre><code>## INFO: folder 'analysis2' read successfully.
##       Ion map data for 256 x 256 pixel frame (10.014 microm^2) for 4 ions recovered: 12C, 13C, 14N12C, 15N12C.
##       33 ROIs identified in the frame.</code></pre>
<pre><code>## INFO: folder 'analysis3' read successfully.
##       Ion map data for 256 x 256 pixel frame (10.014 microm^2) for 4 ions recovered: 12C, 13C, 14N12C, 15N12C.
##       34 ROIs identified in the frame.</code></pre>
<p>The data in these looks similar to the summary data frame except that it is broken out pixel by pixel:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">maps <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="dt">n=</span><span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>()</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">analysis</th>
<th align="right">x.px</th>
<th align="right">y.px</th>
<th align="right">frame_size.px</th>
<th align="right">x.um</th>
<th align="right">y.um</th>
<th align="right">frame_size.um</th>
<th align="left">variable</th>
<th align="left">data_type</th>
<th align="right">value</th>
<th align="right">sigma</th>
<th align="right">ROI</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">analysis1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">256</td>
<td align="right">0.0391172</td>
<td align="right">0.0391172</td>
<td align="right">10.014</td>
<td align="left">12C</td>
<td align="left">ion_count</td>
<td align="right">1721</td>
<td align="right">41.48494</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">256</td>
<td align="right">0.0391172</td>
<td align="right">0.0782344</td>
<td align="right">10.014</td>
<td align="left">12C</td>
<td align="left">ion_count</td>
<td align="right">1694</td>
<td align="right">41.15823</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">256</td>
<td align="right">0.0391172</td>
<td align="right">0.1173516</td>
<td align="right">10.014</td>
<td align="left">12C</td>
<td align="left">ion_count</td>
<td align="right">1508</td>
<td align="right">38.83298</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">256</td>
<td align="right">0.0391172</td>
<td align="right">0.1564688</td>
<td align="right">10.014</td>
<td align="left">12C</td>
<td align="left">ion_count</td>
<td align="right">1297</td>
<td align="right">36.01389</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">256</td>
<td align="right">0.0391172</td>
<td align="right">0.1955859</td>
<td align="right">10.014</td>
<td align="left">12C</td>
<td align="left">ion_count</td>
<td align="right">1136</td>
<td align="right">33.70460</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">256</td>
<td align="right">0.0391172</td>
<td align="right">0.2347031</td>
<td align="right">10.014</td>
<td align="left">12C</td>
<td align="left">ion_count</td>
<td align="right">786</td>
<td align="right">28.03569</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">256</td>
<td align="right">0.0391172</td>
<td align="right">0.2738203</td>
<td align="right">10.014</td>
<td align="left">12C</td>
<td align="left">ion_count</td>
<td align="right">702</td>
<td align="right">26.49528</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="right">1</td>
<td align="right">8</td>
<td align="right">256</td>
<td align="right">0.0391172</td>
<td align="right">0.3129375</td>
<td align="right">10.014</td>
<td align="left">12C</td>
<td align="left">ion_count</td>
<td align="right">453</td>
<td align="right">21.28380</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">analysis1</td>
<td align="right">1</td>
<td align="right">9</td>
<td align="right">256</td>
<td align="right">0.0391172</td>
<td align="right">0.3520547</td>
<td align="right">10.014</td>
<td align="left">12C</td>
<td align="left">ion_count</td>
<td align="right">319</td>
<td align="right">17.86057</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">analysis1</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">256</td>
<td align="right">0.0391172</td>
<td align="right">0.3911719</td>
<td align="right">10.014</td>
<td align="left">12C</td>
<td align="left">ion_count</td>
<td align="right">220</td>
<td align="right">14.83240</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>To make it easier to plot these kind of maps, <strong>lans2r</strong> provides a convenience functoin <code>plot_maps</code> but of course this could be adjusted as needed (look at the source code to see how this one is made). By default ion counts are normalized for each ion so they can be visualized on the same scale.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="../reference/plot_maps.html">plot_maps</a></span>(maps)</a></code></pre></div>
<p><img src="lans2r_files/figure-html/unnamed-chunk-12-1.png" width="1152"></p>
<p>Focusing in on just one ion, we can ditch the normalization, and letâ€™s also not draw ROIs for a direct look. Also, because itâ€™s a <code>ggplot</code>, all ggplot modifications of the plot are fair game.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw"><a href="../reference/plot_maps.html">plot_maps</a></span>(maps <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(variable <span class="op">==</span><span class="st"> "14N12C"</span>, analysis <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"analysis1"</span>, <span class="st">"analysis2"</span>)), </a>
<a class="sourceLine" id="cb23-2" data-line-number="2">          <span class="dt">normalize =</span> <span class="ot">FALSE</span>, <span class="dt">draw_ROIs =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"right"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">fill =</span> <span class="st">"ion count"</span>)</a></code></pre></div>
<p><img src="lans2r_files/figure-html/unnamed-chunk-13-1.png" width="960"></p>
</div>
</div>
<div id="future-directions" class="section level2">
<h2 class="hasAnchor">
<a href="#future-directions" class="anchor"></a>Future directions</h2>
<p>Note that for plotting maps, <em>lans2r</em> does not (yet) support any smoothing so although the <code>plot_maps</code> function theoretically supports plotting ratios and abundances as well (which can be calculated from the maps data the same way using <code>calculate_ratios</code> and <code>calculate_abundances</code>), in practice this does not work so well because individual pixels often have extreme values offsetting proper scaling. This might be part of future expansions if the package sees a lot of use so please email with suggestions if you find it helpful.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#load-data">Load data</a></li>
      <li><a href="#future-directions">Future directions</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sebastian Kopf.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
