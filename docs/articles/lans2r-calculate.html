<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NanoSIMS data processing of LANS data in R: how to use `calculate` • lans2r</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="NanoSIMS data processing of LANS data in R: how to use `calculate`">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lans2r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/lans2r.html">Introduction</a>
</li>
<li>
  <a href="../articles/lans2r-hmr.html">HMR Files</a>
</li>
<li>
  <a href="../articles/lans2r-calculate.html">Calculations</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kopflab/lans2r">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>NanoSIMS data processing of LANS data in R: how to use <code>calculate</code>
</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/KopfLab/lans2r/blob/master/vignettes/lans2r-calculate.Rmd"><code>vignettes/lans2r-calculate.Rmd</code></a></small>
      <div class="hidden name"><code>lans2r-calculate.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lans2r)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(knitr)</a></code></pre></div>
<p>The <code><a href="../reference/calculate.html">?calculate</a></code> function is intended to make it easy and efficient to calculate sets of derived quantities (e.g. ratios from <code>13C</code> and <code>12C</code> data but also from <code>15N12C</code> and <code>14N12C</code> data). It allows defining exactly how the derived quantities should be calculated but also makes it possible to calculate derived errors and how to go about naming the newly derived quantities. Due to its structure it allows for a large amount of flexibility to cover all possible use cases. This vignettes illustrates some basic examples how this may be used to calculate derived quantities from measured ion currents. The functions <code><a href="../reference/calculate_ratios.html">?calculate_ratios</a></code>, <code><a href="../reference/calculate_abundances.html">?calculate_abundances</a></code>, <code><a href="../reference/calculate_sums.html">?calculate_sums</a></code> are all pre-implemented examples of using <code>calculate</code> to achieve a specific task and work out of the box without additional specifications as illustrated in the main vignette.</p>
<div id="test-data" class="section level4">
<h4 class="hasAnchor">
<a href="#test-data" class="anchor"></a>Test data</h4>
<p>For simple illustration, this is a completely contrived artifical data set:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">123</span>) <span class="co"># set random seed</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">test_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">tibble</a></span>(</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    <span class="dt">ROI =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">times =</span> <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">    <span class="dt">variable =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">each =</span> <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    <span class="dt">value =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(<span class="dv">20</span>,<span class="dt">lambda =</span> <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">    <span class="dt">sigma =</span> <span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(value),</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">    <span class="dt">data_type =</span> <span class="st">"raw"</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(test_data, <span class="dt">d =</span> <span class="dv">2</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">ROI</th>
<th align="left">variable</th>
<th align="right">value</th>
<th align="right">sigma</th>
<th align="left">data_type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">8</td>
<td align="right">2.83</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">A</td>
<td align="right">9</td>
<td align="right">3.00</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">A</td>
<td align="right">14</td>
<td align="right">3.74</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">A</td>
<td align="right">10</td>
<td align="right">3.16</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">A</td>
<td align="right">10</td>
<td align="right">3.16</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">B</td>
<td align="right">15</td>
<td align="right">3.87</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">B</td>
<td align="right">11</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">B</td>
<td align="right">5</td>
<td align="right">2.24</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">B</td>
<td align="right">4</td>
<td align="right">2.00</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">B</td>
<td align="right">13</td>
<td align="right">3.61</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">C</td>
<td align="right">11</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">C</td>
<td align="right">11</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">C</td>
<td align="right">10</td>
<td align="right">3.16</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">C</td>
<td align="right">8</td>
<td align="right">2.83</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">C</td>
<td align="right">15</td>
<td align="right">3.87</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">D</td>
<td align="right">11</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">D</td>
<td align="right">3</td>
<td align="right">1.73</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">D</td>
<td align="right">7</td>
<td align="right">2.65</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">D</td>
<td align="right">6</td>
<td align="right">2.45</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">D</td>
<td align="right">8</td>
<td align="right">2.83</td>
<td align="left">raw</td>
</tr>
</tbody>
</table>
</div>
<div id="calculate-products-and-propagate-errors" class="section level4">
<h4 class="hasAnchor">
<a href="#calculate-products-and-propagate-errors" class="anchor"></a>Calculate products and propagate errors</h4>
<p>As a first example, using <code>calculate</code> to calculate different column products and propagate the error by standard error propagation (assuming no covariance).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># functions to calculate values and errors and derive names from the names of the variables used</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># note that they all have to take the same parameters (even if they are not used)</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">my_value_fun &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, x.err, y.err) x<span class="op">*</span>y</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">my_error_fun &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, x.err, y.err) <span class="kw">my_value_fun</span>(x, y, x.err, y.err) <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>((x.err<span class="op">/</span>x)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(y.err<span class="op">/</span>y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">my_name_fun &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, x.err, y.err) <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/deparse.html">deparse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(x)), <span class="st">"*"</span>, <span class="kw"><a href="https://rdrr.io/r/base/deparse.html">deparse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(y)))</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb3-7" data-line-number="7">derived_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="st">  </span>test_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="../reference/calculate.html">calculate</a></span>(</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">    <span class="co"># data type of the derived quantities (can be anything descriptive)</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">    <span class="dt">data_type =</span> <span class="st">"derived"</span>,</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">    <span class="co"># which sets of variables to use for calculations</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">    <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(D, C, <span class="st">`</span><span class="dt">D sigma</span><span class="st">`</span>, <span class="st">`</span><span class="dt">C sigma</span><span class="st">`</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(B, A, <span class="st">`</span><span class="dt">B sigma</span><span class="st">`</span>, <span class="st">`</span><span class="dt">A sigma</span><span class="st">`</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(B, C, <span class="st">`</span><span class="dt">B sigma</span><span class="st">`</span>, <span class="st">`</span><span class="dt">C sigma</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">    <span class="co"># the function to make the calculations</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15">    <span class="dt">value_fun =</span> my_value_fun, <span class="dt">error_fun =</span> my_error_fun, <span class="dt">name_fun =</span> my_name_fun)</a></code></pre></div>
<pre><code>## INFO: 15 'derived' values + errors calculated, 15 added (subset: all)
##       values added (stored in 'variable' column): 'B*A' (5x), 'B*C' (5x), 'D*C' (5x)</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(derived_data, <span class="dt">d =</span> <span class="dv">2</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">ROI</th>
<th align="left">variable</th>
<th align="right">value</th>
<th align="right">sigma</th>
<th align="left">data_type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">8</td>
<td align="right">2.83</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">A</td>
<td align="right">9</td>
<td align="right">3.00</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">A</td>
<td align="right">14</td>
<td align="right">3.74</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">A</td>
<td align="right">10</td>
<td align="right">3.16</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">A</td>
<td align="right">10</td>
<td align="right">3.16</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">B</td>
<td align="right">15</td>
<td align="right">3.87</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">B</td>
<td align="right">11</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">B</td>
<td align="right">5</td>
<td align="right">2.24</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">B</td>
<td align="right">4</td>
<td align="right">2.00</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">B</td>
<td align="right">13</td>
<td align="right">3.61</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">C</td>
<td align="right">11</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">C</td>
<td align="right">11</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">C</td>
<td align="right">10</td>
<td align="right">3.16</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">C</td>
<td align="right">8</td>
<td align="right">2.83</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">C</td>
<td align="right">15</td>
<td align="right">3.87</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">D</td>
<td align="right">11</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">D</td>
<td align="right">3</td>
<td align="right">1.73</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">D</td>
<td align="right">7</td>
<td align="right">2.65</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">D</td>
<td align="right">6</td>
<td align="right">2.45</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">D</td>
<td align="right">8</td>
<td align="right">2.83</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">D*C</td>
<td align="right">121</td>
<td align="right">51.59</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">D*C</td>
<td align="right">33</td>
<td align="right">21.49</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">D*C</td>
<td align="right">70</td>
<td align="right">34.50</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">D*C</td>
<td align="right">48</td>
<td align="right">25.92</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">D*C</td>
<td align="right">120</td>
<td align="right">52.54</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">B*A</td>
<td align="right">120</td>
<td align="right">52.54</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">B*A</td>
<td align="right">99</td>
<td align="right">44.50</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">B*A</td>
<td align="right">70</td>
<td align="right">36.47</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">B*A</td>
<td align="right">40</td>
<td align="right">23.66</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">B*A</td>
<td align="right">130</td>
<td align="right">54.68</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">B*C</td>
<td align="right">165</td>
<td align="right">65.50</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">B*C</td>
<td align="right">121</td>
<td align="right">51.59</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">B*C</td>
<td align="right">50</td>
<td align="right">27.39</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">B*C</td>
<td align="right">32</td>
<td align="right">19.60</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">B*C</td>
<td align="right">195</td>
<td align="right">73.89</td>
<td align="left">derived</td>
</tr>
</tbody>
</table>
</div>
<div id="calculate-sums-of-derived-quantities" class="section level4">
<h4 class="hasAnchor">
<a href="#calculate-sums-of-derived-quantities" class="anchor"></a>Calculate sums of derived quantities</h4>
<p>As a second example, build on the derived quantities to generate custom sums (again with standard error propagation):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">my_value_fun &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, x.err, y.err) x<span class="op">+</span>y</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">my_error_fun &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, x.err, y.err) <span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(x.err<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>y.err<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">my_name_fun &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, x.err, y.err) <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/deparse.html">deparse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(x)), <span class="st">"+"</span>, <span class="kw"><a href="https://rdrr.io/r/base/deparse.html">deparse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span>(y)))</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">derived_data2 &lt;-</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span>derived_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="../reference/calculate.html">calculate</a></span>(</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">    <span class="co"># data type of the derived quantities (can be anything descriptive)</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9">    <span class="dt">data_type =</span> <span class="st">"derived2"</span>,</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">    <span class="co"># which sets of variables to use for calculations</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">    <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(D, C, <span class="st">`</span><span class="dt">D sigma</span><span class="st">`</span>, <span class="st">`</span><span class="dt">C sigma</span><span class="st">`</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">`</span><span class="dt">B*A</span><span class="st">`</span>, <span class="st">`</span><span class="dt">C</span><span class="st">`</span>, <span class="st">`</span><span class="dt">B*A sigma</span><span class="st">`</span>, <span class="st">`</span><span class="dt">C sigma</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">    <span class="co"># the function to make the calculations</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13">    <span class="dt">value_fun =</span> my_value_fun, <span class="dt">error_fun =</span> my_error_fun, <span class="dt">name_fun =</span> my_name_fun)</a></code></pre></div>
<pre><code>## INFO: 10 'derived2' values + errors calculated, 10 added (subset: all)
##       values added (stored in 'variable' column): 'B*A+C' (5x), 'D+C' (5x)</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(derived_data2, <span class="dt">d =</span> <span class="dv">2</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">ROI</th>
<th align="left">variable</th>
<th align="right">value</th>
<th align="right">sigma</th>
<th align="left">data_type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">8</td>
<td align="right">2.83</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">A</td>
<td align="right">9</td>
<td align="right">3.00</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">A</td>
<td align="right">14</td>
<td align="right">3.74</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">A</td>
<td align="right">10</td>
<td align="right">3.16</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">A</td>
<td align="right">10</td>
<td align="right">3.16</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">B</td>
<td align="right">15</td>
<td align="right">3.87</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">B</td>
<td align="right">11</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">B</td>
<td align="right">5</td>
<td align="right">2.24</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">B</td>
<td align="right">4</td>
<td align="right">2.00</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">B</td>
<td align="right">13</td>
<td align="right">3.61</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">C</td>
<td align="right">11</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">C</td>
<td align="right">11</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">C</td>
<td align="right">10</td>
<td align="right">3.16</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">C</td>
<td align="right">8</td>
<td align="right">2.83</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">C</td>
<td align="right">15</td>
<td align="right">3.87</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">D</td>
<td align="right">11</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">D</td>
<td align="right">3</td>
<td align="right">1.73</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">D</td>
<td align="right">7</td>
<td align="right">2.65</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">D</td>
<td align="right">6</td>
<td align="right">2.45</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">D</td>
<td align="right">8</td>
<td align="right">2.83</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">D*C</td>
<td align="right">121</td>
<td align="right">51.59</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">D*C</td>
<td align="right">33</td>
<td align="right">21.49</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">D*C</td>
<td align="right">70</td>
<td align="right">34.50</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">D*C</td>
<td align="right">48</td>
<td align="right">25.92</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">D*C</td>
<td align="right">120</td>
<td align="right">52.54</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">B*A</td>
<td align="right">120</td>
<td align="right">52.54</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">B*A</td>
<td align="right">99</td>
<td align="right">44.50</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">B*A</td>
<td align="right">70</td>
<td align="right">36.47</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">B*A</td>
<td align="right">40</td>
<td align="right">23.66</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">B*A</td>
<td align="right">130</td>
<td align="right">54.68</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">B*C</td>
<td align="right">165</td>
<td align="right">65.50</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">B*C</td>
<td align="right">121</td>
<td align="right">51.59</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">B*C</td>
<td align="right">50</td>
<td align="right">27.39</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">B*C</td>
<td align="right">32</td>
<td align="right">19.60</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">B*C</td>
<td align="right">195</td>
<td align="right">73.89</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">D+C</td>
<td align="right">22</td>
<td align="right">4.69</td>
<td align="left">derived2</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">D+C</td>
<td align="right">14</td>
<td align="right">3.74</td>
<td align="left">derived2</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">D+C</td>
<td align="right">17</td>
<td align="right">4.12</td>
<td align="left">derived2</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">D+C</td>
<td align="right">14</td>
<td align="right">3.74</td>
<td align="left">derived2</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">D+C</td>
<td align="right">23</td>
<td align="right">4.80</td>
<td align="left">derived2</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">B*A+C</td>
<td align="right">131</td>
<td align="right">52.64</td>
<td align="left">derived2</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">B*A+C</td>
<td align="right">110</td>
<td align="right">44.62</td>
<td align="left">derived2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">B*A+C</td>
<td align="right">80</td>
<td align="right">36.61</td>
<td align="left">derived2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">B*A+C</td>
<td align="right">48</td>
<td align="right">23.83</td>
<td align="left">derived2</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">B*A+C</td>
<td align="right">145</td>
<td align="right">54.82</td>
<td align="left">derived2</td>
</tr>
</tbody>
</table>
</div>
<div id="calculate-derived-quantity-no-error-and-direct-naming" class="section level4">
<h4 class="hasAnchor">
<a href="#calculate-derived-quantity-no-error-and-direct-naming" class="anchor"></a>Calculate derived quantity (no error, and direct naming)</h4>
<p>To calculate a derived quantity without calculating errors, simply don’t supply an error function. Also illustrated here is a simple way to provide specific variable names and defining the functions in line. Note the use of <code><a href="https://rdrr.io/r/base/sum.html">sum(x)</a></code> as well, this can easily be used for calculating normalized derived quantities.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">derived_data3 &lt;-</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span>derived_data2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/calculate.html">calculate</a></span>(</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">    <span class="co"># data type of the derived quantities (can be anything descriptive)</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">    <span class="dt">data_type =</span> <span class="st">"special"</span>,</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">    <span class="co"># which sets of variables to use for calculations</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"my_var"</span>, A, B, C),</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    <span class="co"># the function to make the calculations</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">    <span class="dt">value_fun =</span> <span class="cf">function</span>(name, x, y, z) x<span class="op">+</span>y<span class="op">^</span><span class="dv">2</span><span class="op">+</span>z<span class="op">^</span><span class="dv">3</span><span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(x),</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">    <span class="dt">name_fun =</span> <span class="cf">function</span>(name, x, y, z) name)</a></code></pre></div>
<pre><code>## INFO: 5 'special' values + errors calculated, 5 added (subset: all)
##       values added (stored in 'variable' column): 'my_var' (5x)</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(derived_data3, <span class="dt">d =</span> <span class="dv">2</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">ROI</th>
<th align="left">variable</th>
<th align="right">value</th>
<th align="right">sigma</th>
<th align="left">data_type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">8.00</td>
<td align="right">2.83</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">A</td>
<td align="right">9.00</td>
<td align="right">3.00</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">A</td>
<td align="right">14.00</td>
<td align="right">3.74</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">A</td>
<td align="right">10.00</td>
<td align="right">3.16</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">A</td>
<td align="right">10.00</td>
<td align="right">3.16</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">B</td>
<td align="right">15.00</td>
<td align="right">3.87</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">B</td>
<td align="right">11.00</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">B</td>
<td align="right">5.00</td>
<td align="right">2.24</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">B</td>
<td align="right">4.00</td>
<td align="right">2.00</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">B</td>
<td align="right">13.00</td>
<td align="right">3.61</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">C</td>
<td align="right">11.00</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">C</td>
<td align="right">11.00</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">C</td>
<td align="right">10.00</td>
<td align="right">3.16</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">C</td>
<td align="right">8.00</td>
<td align="right">2.83</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">C</td>
<td align="right">15.00</td>
<td align="right">3.87</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">D</td>
<td align="right">11.00</td>
<td align="right">3.32</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">D</td>
<td align="right">3.00</td>
<td align="right">1.73</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">D</td>
<td align="right">7.00</td>
<td align="right">2.65</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">D</td>
<td align="right">6.00</td>
<td align="right">2.45</td>
<td align="left">raw</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">D</td>
<td align="right">8.00</td>
<td align="right">2.83</td>
<td align="left">raw</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">D*C</td>
<td align="right">121.00</td>
<td align="right">51.59</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">D*C</td>
<td align="right">33.00</td>
<td align="right">21.49</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">D*C</td>
<td align="right">70.00</td>
<td align="right">34.50</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">D*C</td>
<td align="right">48.00</td>
<td align="right">25.92</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">D*C</td>
<td align="right">120.00</td>
<td align="right">52.54</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">B*A</td>
<td align="right">120.00</td>
<td align="right">52.54</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">B*A</td>
<td align="right">99.00</td>
<td align="right">44.50</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">B*A</td>
<td align="right">70.00</td>
<td align="right">36.47</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">B*A</td>
<td align="right">40.00</td>
<td align="right">23.66</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">B*A</td>
<td align="right">130.00</td>
<td align="right">54.68</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">B*C</td>
<td align="right">165.00</td>
<td align="right">65.50</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">B*C</td>
<td align="right">121.00</td>
<td align="right">51.59</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">B*C</td>
<td align="right">50.00</td>
<td align="right">27.39</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">B*C</td>
<td align="right">32.00</td>
<td align="right">19.60</td>
<td align="left">derived</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">B*C</td>
<td align="right">195.00</td>
<td align="right">73.89</td>
<td align="left">derived</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">D+C</td>
<td align="right">22.00</td>
<td align="right">4.69</td>
<td align="left">derived2</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">D+C</td>
<td align="right">14.00</td>
<td align="right">3.74</td>
<td align="left">derived2</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">D+C</td>
<td align="right">17.00</td>
<td align="right">4.12</td>
<td align="left">derived2</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">D+C</td>
<td align="right">14.00</td>
<td align="right">3.74</td>
<td align="left">derived2</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">D+C</td>
<td align="right">23.00</td>
<td align="right">4.80</td>
<td align="left">derived2</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">B*A+C</td>
<td align="right">131.00</td>
<td align="right">52.64</td>
<td align="left">derived2</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">B*A+C</td>
<td align="right">110.00</td>
<td align="right">44.62</td>
<td align="left">derived2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">B*A+C</td>
<td align="right">80.00</td>
<td align="right">36.61</td>
<td align="left">derived2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">B*A+C</td>
<td align="right">48.00</td>
<td align="right">23.83</td>
<td align="left">derived2</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">B*A+C</td>
<td align="right">145.00</td>
<td align="right">54.82</td>
<td align="left">derived2</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">my_var</td>
<td align="right">259.10</td>
<td align="right">NA</td>
<td align="left">special</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">my_var</td>
<td align="right">156.10</td>
<td align="right">NA</td>
<td align="left">special</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">my_var</td>
<td align="right">58.61</td>
<td align="right">NA</td>
<td align="left">special</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">my_var</td>
<td align="right">36.04</td>
<td align="right">NA</td>
<td align="left">special</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">my_var</td>
<td align="right">245.18</td>
<td align="right">NA</td>
<td align="left">special</td>
</tr>
</tbody>
</table>
</div>
<div id="data-visualization" class="section level1">
<h1 class="hasAnchor">
<a href="#data-visualization" class="anchor"></a>Data visualization</h1>
<p>This data format makes it easy to have arbitrarily elaborate derived quantities and dynamically include the same calculation for multiple sets of variables. It is also a format that lends itself very well to visualiztion:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">derived_data3 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> ROI, <span class="dt">y =</span> value, <span class="dt">ymin =</span> value<span class="op">-</span>sigma, <span class="dt">ymax =</span> value<span class="op">+</span>sigma, <span class="dt">color =</span> variable) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>data_type, <span class="dt">scales =</span> <span class="st">"free"</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 5 rows containing missing values (geom_errorbar).</code></pre>
<p><img src="lans2r-calculate_files/figure-html/unnamed-chunk-6-1.png" width="864"></p>
</div>
<div id="data-overview" class="section level1">
<h1 class="hasAnchor">
<a href="#data-overview" class="anchor"></a>Data overview</h1>
<p>Lastly, it can be very useful to have data converted to a wide format with all variables and errors next to each other (e.g. for summary tables or export to Excel). This is easily accomplished with <em>lans2r</em>’s <code>spread_data</code> function:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">derived_data3 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/spread_data.html">spread_data</a></span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="dt">d =</span> <span class="dv">2</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">ROI</th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">B*A</th>
<th align="right">B*A+C</th>
<th align="right">B*C</th>
<th align="right">C</th>
<th align="right">D</th>
<th align="right">D*C</th>
<th align="right">D+C</th>
<th align="right">my_var</th>
<th align="right">A sigma</th>
<th align="right">B sigma</th>
<th align="right">B*A sigma</th>
<th align="right">B*A+C sigma</th>
<th align="right">B*C sigma</th>
<th align="right">C sigma</th>
<th align="right">D sigma</th>
<th align="right">D*C sigma</th>
<th align="right">D+C sigma</th>
<th align="right">my_var sigma</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">8</td>
<td align="right">15</td>
<td align="right">120</td>
<td align="right">131</td>
<td align="right">165</td>
<td align="right">11</td>
<td align="right">11</td>
<td align="right">121</td>
<td align="right">22</td>
<td align="right">259.10</td>
<td align="right">2.83</td>
<td align="right">3.87</td>
<td align="right">52.54</td>
<td align="right">52.64</td>
<td align="right">65.50</td>
<td align="right">3.32</td>
<td align="right">3.32</td>
<td align="right">51.59</td>
<td align="right">4.69</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">9</td>
<td align="right">11</td>
<td align="right">99</td>
<td align="right">110</td>
<td align="right">121</td>
<td align="right">11</td>
<td align="right">3</td>
<td align="right">33</td>
<td align="right">14</td>
<td align="right">156.10</td>
<td align="right">3.00</td>
<td align="right">3.32</td>
<td align="right">44.50</td>
<td align="right">44.62</td>
<td align="right">51.59</td>
<td align="right">3.32</td>
<td align="right">1.73</td>
<td align="right">21.49</td>
<td align="right">3.74</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">14</td>
<td align="right">5</td>
<td align="right">70</td>
<td align="right">80</td>
<td align="right">50</td>
<td align="right">10</td>
<td align="right">7</td>
<td align="right">70</td>
<td align="right">17</td>
<td align="right">58.61</td>
<td align="right">3.74</td>
<td align="right">2.24</td>
<td align="right">36.47</td>
<td align="right">36.61</td>
<td align="right">27.39</td>
<td align="right">3.16</td>
<td align="right">2.65</td>
<td align="right">34.50</td>
<td align="right">4.12</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">10</td>
<td align="right">4</td>
<td align="right">40</td>
<td align="right">48</td>
<td align="right">32</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">48</td>
<td align="right">14</td>
<td align="right">36.04</td>
<td align="right">3.16</td>
<td align="right">2.00</td>
<td align="right">23.66</td>
<td align="right">23.83</td>
<td align="right">19.60</td>
<td align="right">2.83</td>
<td align="right">2.45</td>
<td align="right">25.92</td>
<td align="right">3.74</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">10</td>
<td align="right">13</td>
<td align="right">130</td>
<td align="right">145</td>
<td align="right">195</td>
<td align="right">15</td>
<td align="right">8</td>
<td align="right">120</td>
<td align="right">23</td>
<td align="right">245.18</td>
<td align="right">3.16</td>
<td align="right">3.61</td>
<td align="right">54.68</td>
<td align="right">54.82</td>
<td align="right">73.89</td>
<td align="right">3.87</td>
<td align="right">2.83</td>
<td align="right">52.54</td>
<td align="right">4.80</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">derived_data3 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/spread_data.html">spread_data</a></span>(<span class="dt">errors =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="dt">d =</span> <span class="dv">2</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">ROI</th>
<th align="right">A</th>
<th align="right">B</th>
<th align="right">B*A</th>
<th align="right">B*A+C</th>
<th align="right">B*C</th>
<th align="right">C</th>
<th align="right">D</th>
<th align="right">D*C</th>
<th align="right">D+C</th>
<th align="right">my_var</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">8</td>
<td align="right">15</td>
<td align="right">120</td>
<td align="right">131</td>
<td align="right">165</td>
<td align="right">11</td>
<td align="right">11</td>
<td align="right">121</td>
<td align="right">22</td>
<td align="right">259.10</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">9</td>
<td align="right">11</td>
<td align="right">99</td>
<td align="right">110</td>
<td align="right">121</td>
<td align="right">11</td>
<td align="right">3</td>
<td align="right">33</td>
<td align="right">14</td>
<td align="right">156.10</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">14</td>
<td align="right">5</td>
<td align="right">70</td>
<td align="right">80</td>
<td align="right">50</td>
<td align="right">10</td>
<td align="right">7</td>
<td align="right">70</td>
<td align="right">17</td>
<td align="right">58.61</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">10</td>
<td align="right">4</td>
<td align="right">40</td>
<td align="right">48</td>
<td align="right">32</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">48</td>
<td align="right">14</td>
<td align="right">36.04</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">10</td>
<td align="right">13</td>
<td align="right">130</td>
<td align="right">145</td>
<td align="right">195</td>
<td align="right">15</td>
<td align="right">8</td>
<td align="right">120</td>
<td align="right">23</td>
<td align="right">245.18</td>
</tr>
</tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#data-visualization">Data visualization</a></li>
      <li><a href="#data-overview">Data overview</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sebastian Kopf.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
